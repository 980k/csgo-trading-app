{"ast":null,"code":"var _jsxFileName = \"/Users/kevin/Code/Repos/csgo-trading-app-v2/client/src/components/login/LoginForm.jsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useContext } from 'react';\nimport { useNavigate } from \"react-router-dom\";\nimport AuthContext from \"../../context/AuthContext\";\nimport jwtDecode from 'jwt-decode';\nimport '../../styles/components/LoginForm.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function LoginForm() {\n  _s();\n  const authContext = useContext(AuthContext);\n  useEffect(() => {\n    const auth_token = sessionStorage.getItem('auth_token');\n    if (auth_token !== null) {\n      console.log('Auth token present');\n      redirect(auth_token);\n    } else {\n      console.log('No Auth token present');\n    }\n  }, []);\n  const handleSubmit = async e => {\n    e.preventDefault();\n    const username = document.getElementById('username').value;\n    const password = document.getElementById('password').value;\n    let error = document.getElementById(\"error-text\");\n    const requestBody = {\n      username,\n      password\n    };\n    const res = await fetch(\"http://localhost:4000/user/login\", {\n      method: 'POST',\n      headers: {\n        \"Content-Type\": 'application/json'\n      },\n      body: JSON.stringify(requestBody)\n    }).then(response => {\n      response.json().then(data => {\n        if (response.status !== 200) {\n          error.innerHTML = data.msg;\n        } else {\n          sessionStorage.setItem('auth_token', data.token);\n          sessionStorage.setItem('isAuthenticated', 'true');\n          authContext.login();\n          redirect(data.token);\n        }\n      });\n    }).catch(error => {\n      console.log(error);\n    });\n  };\n  const navigate = useNavigate();\n  async function redirect(token) {\n    const decoded = jwtDecode(token);\n    const userId = decoded.user.id;\n    const userResponse = await fetch(`http://localhost:4000/user/${userId}`, {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    });\n    if (userResponse.status === 200) {\n      navigate('/');\n    } else {\n      console.log('Error retrieving data.');\n    }\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"login-form-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Login\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: handleSubmit,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"login-elements\",\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          id: \"username\",\n          name: \"username\",\n          placeholder: \"Username\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 79,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"password\",\n          id: \"password\",\n          name: \"password\",\n          placeholder: \"Password\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 80,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"error\",\n          id: \"error-text\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 81,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"login-button\",\n        children: \"Log In\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 75,\n    columnNumber: 9\n  }, this);\n}\n_s(LoginForm, \"yk3mepP2uQ7xqCHW8NG+dufOOqs=\", false, function () {\n  return [useNavigate];\n});\n_c = LoginForm;\nvar _c;\n$RefreshReg$(_c, \"LoginForm\");","map":{"version":3,"names":["React","useEffect","useContext","useNavigate","AuthContext","jwtDecode","jsxDEV","_jsxDEV","LoginForm","_s","authContext","auth_token","sessionStorage","getItem","console","log","redirect","handleSubmit","e","preventDefault","username","document","getElementById","value","password","error","requestBody","res","fetch","method","headers","body","JSON","stringify","then","response","json","data","status","innerHTML","msg","setItem","token","login","catch","navigate","decoded","userId","user","id","userResponse","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onSubmit","type","name","placeholder","_c","$RefreshReg$"],"sources":["/Users/kevin/Code/Repos/csgo-trading-app-v2/client/src/components/login/LoginForm.jsx"],"sourcesContent":["import React, { useEffect, useContext } from 'react';\nimport { useNavigate } from \"react-router-dom\";\nimport AuthContext from \"../../context/AuthContext\";\nimport jwtDecode from 'jwt-decode';\nimport '../../styles/components/LoginForm.css'\n\nexport default function LoginForm() {\n    const authContext = useContext(AuthContext);\n\n    useEffect(() => {\n        const auth_token = sessionStorage.getItem('auth_token');\n        if(auth_token !== null) {\n            console.log('Auth token present');\n            redirect(auth_token);\n        } else {\n            console.log('No Auth token present');\n        }\n    }, [])\n\n    const handleSubmit = async (e) => {\n        e.preventDefault();\n\n        const username = document.getElementById('username').value;\n        const password = document.getElementById('password').value;\n        let error = document.getElementById(\"error-text\");\n\n        const requestBody = {\n            username,\n            password\n        }\n\n        const res = await fetch(\"http://localhost:4000/user/login\",{\n            method: 'POST',\n            headers:{\n                \"Content-Type\":'application/json'\n            },\n            body: JSON.stringify(requestBody)\n        }).then(response => {\n            response.json().then(data => {\n                if(response.status !== 200){\n                    error.innerHTML = data.msg;\n                } else {\n                    sessionStorage.setItem('auth_token', data.token);\n                    sessionStorage.setItem('isAuthenticated', 'true');\n                    authContext.login();\n                    redirect(data.token);\n                }\n            });\n        }).catch(error =>{\n            console.log(error);\n        });\n    };\n\n    const navigate = useNavigate();\n\n    async function redirect(token) {\n        const decoded = jwtDecode(token);\n        const userId = decoded.user.id;\n\n        const userResponse = await fetch(`http://localhost:4000/user/${userId}`, {\n            method: 'GET',\n            headers: {\n                'Content-Type': 'application/json',\n            }\n        });\n\n        if (userResponse.status === 200) {\n            navigate('/');\n        } else {\n            console.log('Error retrieving data.')\n        }\n    }\n\n    return(\n        <div className=\"login-form-container\">\n            <h2>Login</h2>\n            <form onSubmit={handleSubmit}>\n                <div className=\"login-elements\">\n                    <input type=\"text\" id=\"username\" name=\"username\" placeholder=\"Username\" />\n                    <input type=\"password\" id=\"password\" name=\"password\" placeholder=\"Password\" />\n                    <div className=\"error\" id=\"error-text\"></div>\n                </div>\n                <button className=\"login-button\">Log In</button>\n            </form>\n        </div>\n    );\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}